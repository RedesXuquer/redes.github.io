<h1 id="hibernate">Hibernate</h1>
<p>Con la siguiente estructura de MySQL:</p>
<pre><code class="language-SQL">
CREATE DATABASE canciones;

CREATE TABLE `song` (
  `songId` int(11) NOT NULL,
  `songName` varchar(25) NOT NULL,
  `singer` varchar(25) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
</code></pre>

<ol>
  <li>
    <p>Añadimos las librerías, deben quedar de la siguiente manera:
<img src="Captura de pantalla 2024-01-10 200549.png" alt="Alt text" />
<img src="Captura de pantalla 2024-01-10 200537.png" alt="Alt text" />
<img src="Captura de pantalla 2024-01-10 200802.png" alt="Alt text" /></p>
  </li>
  <li>
    <p>Añadimos un archivo XML dento de nuestro proyecto, se debe llamar <em>*hibernate.cfg.xml</em> con el siguiente contenido:
```XML
&lt;?xml version = “1.0” encoding = “utf-8”?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC
     “-//Hibernate/Hibernate Configuration DTD 3.0//EN”
     “http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd”&gt;</p>
  </li>
</ol>
<hibernate-configuration>
    <session-factory>
        <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
        <!-- Set URL -->
        <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/canciones</property>
        //<property name="hibernate.connection.url">jdbc:mysql://**direccion_server**:**puerto**/**nombre_BBDD**</property>
        <!-- Set User Name -->
        <property name="hibernate.connection.username">2DAM</property>
        //<property name="hibernate.connection.username">**User_BBDD**</property>
        <!-- Set Password -->
        <property name="hibernate.connection.password">2DAM2023</property>
        //<property name="hibernate.connection.password">**Pass_BBDD**</property>
        <!-- Set Driver Name -->
        <property name="hibernate.show_sql">true</property>
        
    </session-factory>
</hibernate-configuration>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
1. Añadimos una clase con el siguiente contenido:
```JAVA
// Importing required classes
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;


@Entity
// Seleccionamos el nombre de la tabla
@Table(name = "song")
 
// POJO class
public class Song {

    // Indicamos el tipo ID y le marcamos el nombre de la columna, en este caso songId. Después le marcamos el tipo de dato, en este caso **int** y el nombre de la variable id.
    @Id @Column(name = "songId") private int id;

    // Indicamos el nombre de la segunda columna **songName**. Después le marcamos el tipo de dato, en este caso **String** y el nombre de la variable songName.
    @Column(name = "songName") private String songName;
 
    // Indicamos el nombre de la tercera columna **singer**. Después le marcamos el tipo de dato, en este caso **String** y el nombre de la variable artist.
    @Column(name = "singer") private String artist;
 
    // Método con el cual devolvemos el ID
    public int getId() { return id; }
 
    // Método con el cual establecemos el ID
    public void setId(int id) { this.id = id; }
 
    // Método con el cual devolvemos el nombre de la canción
    public String getSongName() { return songName; }

    // Método con el cual establecemos el nombre de la canción 
    public void setSongName(String songName)
    {
        this.songName = songName;
    }

    // Método con el cual devolvemos el nombre del artista
    public String getArtist() { return artist; }

    // Método con el cual establecemos el nombre del artista 
    public void setArtist(String artist)
    {
        this.artist = artist;
    }
}
</code></pre></div></div>
<ol>
  <li>Los import:
    <pre><code class="language-JAVA">import java.util.HashSet;
import java.util.List;
import java.util.Set;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;
</code></pre>
  </li>
  <li>Trabajando con las sesiones:
    <pre><code class="language-JAVA"> void crearSession(){    
     Configuration configuration = new Configuration();
     configuration.configure("hibernate.cfg.xml");
     configuration.addAnnotatedClass(Song.class);
     this.sessionFactory = configuration.buildSessionFactory();
     //return sessionFactory;
 }
</code></pre>
  </li>
  <li>CRUD</li>
</ol>

<p>Create</p>
<pre><code class="language-JAVA">    void crearCancion(String songName, String artist) {
        try (Session session = this.sessionFactory.openSession()) {
            session.beginTransaction();

            Song nuevo = new Song();
            nuevo.setSongName(songName);
            nuevo.setArtist(artist);

            session.save(nuevo);
            session.getTransaction().commit();
            session.close();
        }
    }
</code></pre>

<p>Read</p>
<pre><code class="language-JAVA">    void crearCancion(String songName, String artist) {
        try (Session session = this.sessionFactory.openSession()) {
            session.beginTransaction();

            Song nuevo = new Song();
            nuevo.setSongName(songName);
            nuevo.setArtist(artist);

            session.save(nuevo);
            session.getTransaction().commit();
            session.close();
        }
    }
</code></pre>

<p>Update</p>
<pre><code class="language-JAVA">    void actualizarProducto(int id, String songName, String artist) {
        try (Session session = this.sessionFactory.openSession()) {
            session.beginTransaction();

            // Obtener el producto a actualizar
            Song cancion = session.get(Song.class, id);

            // Actualizar los campos
            if (cancion != null) {
                cancion.setSongName(songName);
                cancion.setArtist(artist);
            }

            session.getTransaction().commit();
            session.close();
        }
    }
</code></pre>

<p>Delete</p>
<pre><code class="language-JAVA">    void eliminarProducto(int id) {
        try (Session session = this.sessionFactory.openSession()) {
            session.beginTransaction();

            // Obtener el producto a eliminar
            Song cancion = session.get(Song.class, id);

            // Eliminar el producto
            if (cancion != null) {
                session.delete(cancion);
            }
            session.getTransaction().commit();
            session.close();
        }
    }
</code></pre>

<p>Para finalizar la sesión:</p>
<pre><code class="language-JAVA">    void cerrar(){
        this.sessionFactory.close();
    }
</code></pre>
